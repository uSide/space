
<!DOCTYPE HTML>
<html>
<head>
    <title>deus</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #fff;
        }
    </style>
    <script src="/pixi.js"></script>
    <script src="/mousetrap.min.js"></script>

</head>
<body>
    <script>
    var renderer = PIXI.autoDetectRenderer(900, 300);
    document.body.appendChild(renderer.view);
    // create an new instance of a pixi stage
    var stage = new PIXI.Stage(0x66FF99);

    // create a texture from an image path
    var backgroundTexture = PIXI.Texture.fromImage("/bg.jpg");
    // create a new Sprite using the texture
    var background = new PIXI.Sprite(backgroundTexture);

    // create a texture from an image path
    var bunnyTexture = PIXI.Texture.fromImage("/bunny.png");
    // create a new Sprite using the texture
    var bunny = new PIXI.Sprite(bunnyTexture);

    // center the sprites anchor point
    bunny.anchor.x = 0.5;
    bunny.anchor.y = 0.5;

    // move the sprite t the center of the screen
    bunny.position.x = 200;
    bunny.position.y = 100;

    // move the sprite t the center of the screen
    background.position.x = 0;
    background.position.y = 0;

    stage.addChild(background);
    stage.addChild(bunny);

    var render = function(){
        console.log(1);
        requestAnimationFrame(render);

        // bunny.rotation += 0.1;

        renderer.render(stage);
    }

    var keys = {
        right: false,
        left: false,
        up: false
    }

    Mousetrap.bind('right', function() {
        keys.right = true;
    });

    Mousetrap.bind('right', function() {
        keys.right = false;
    }, 'keyup');

    Mousetrap.bind('left', function() {
        keys.left = true;
    });

    Mousetrap.bind('left', function() {
        keys.left = false;
    }, 'keyup');

    Mousetrap.bind('up', function() {
        keys.up = true;
    });

    Mousetrap.bind('up', function() {
        keys.up = false;
    }, 'keyup');

    setInterval(function(){
        if(keys.right){
            bunny.rotation += 0.1;
        }
        if(keys.left){
            bunny.rotation -= 0.1;
        }
        if(keys.up){
            var angle = Math.abs(bunny.rotation) % (2 * Math.PI);

            var deltas = polarToRect(1, angle);

            bunny.position.x += deltas[0];
            bunny.position.y -= deltas[1];
        }
    }, 10);

    function rectToPolar(x, y){
        return [
            Math.sqrt(x * x + y * y),
            Math.atan2(x, y)
        ];
    }

    function polarToRect(r, phi){
        return [
            r * Math.sin(phi),
            r * Math.cos(phi)
        ];
    }

    requestAnimationFrame(render);
    </script>

    </body>
</html>